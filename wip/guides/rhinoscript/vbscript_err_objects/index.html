<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>VBScript Err Objects</title>
  <meta name="description" content="VBScript Err Objects">

  <!-- OpenGraph for Facebook, Twitter, Slack unfurling -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/guides/rhinoscript/vbscript_err_objects/" />
  <meta property="og:title" content="VBScript Err Objects" />
  <meta property="og:description" content="This guide discusses the VBScript Err object." />
  <meta property=”og:site_name” content="developer.rhino3d.com"/>
  <meta property=”og:image” content="/wip/images/rhinodev_logo_unfurl.png"/>

  <!-- twitter card tags additive with the og: tags -->
  <meta name="twitter:domain" value="developer.rhino3d.com" />
  <meta name="twitter:title" value="VBScript Err Objects" />
  <meta name="twitter:description" value="This guide discusses the VBScript Err object." />
  
    
      <meta name="twitter:image" content="/wip/images/rhinodev_logo_unfurl.png" />
    
  
  <meta name="twitter:url" value="http://developer.rhino3d.com" />
  
  <meta name="twitter:label1" value="Platform(s)" />
  <meta name="twitter:data1" value="Windows" />
  
  
  <meta name="twitter:label2" value="Language(s)" />
  <meta name="twitter:data2" value="VBScript" />
  

  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css">
  <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/languages/vbnet.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <!-- Check the version banner for broken links and remove the link if found -->
  <!-- <script type="text/javascript" src="/script/banner_sanity.js"></script> -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script>
  $.ready(function()
  {
  	var splitPath = window.location.pathname.split("/");
  	var nonWipURL = "/" + splitPath.splice(2,splitPath.length-2).join("/");

  	$.get(nonWipURL).fail(function ()
  	{
      console.log("stripping link");
      var $aTag = $("div.version-banner > a");
  		$aTag.remove();
  	});
  });
  </script>

  <!-- Overridden theme -->
  <link rel="stylesheet" href="/wip/css/main.css">

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
  <!-- Bootstrap override -->
  <link rel="stylesheet" href="/wip/css/bootstrap-override.css">

  <link rel="canonical" href="http://developer.rhino3d.com/wip/guides/rhinoscript/vbscript_err_objects/">
  <link rel="alternate" type="application/rss+xml" title="Rhino Developer Docs" href="http://developer.rhino3d.com/wip/feed.xml" />

  <link rel="shortcut icon" href="http://developer.rhino3d.com/favicon.ico?v=2" />
  <!-- Saving bookmarks to mobile devices -->
  <!-- For non-Retina (@1× display) iPhone, iPod Touch, and Android 2.1+ devices: -->
  <link rel="apple-touch-icon-precomposed" href="/wip/images/apple-touch-icon-precomposed.png"><!-- 57×57px -->
  <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/wip/images/apple-touch-icon-72x72-precomposed.png">
  <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/wip/images/apple-touch-icon-76x76-precomposed.png">
  <!-- For iPhone with @2× display running iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/wip/images/apple-touch-icon-114x114-precomposed.png">
  <!-- For iPhone with @2× display running iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/wip/images/apple-touch-icon-120x120-precomposed.png">
  <!-- For iPad with @2× display running iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/wip/images/apple-touch-icon-144x144-precomposed.png">
  <!-- For iPad with @2× display running iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/wip/images/apple-touch-icon-152x152-precomposed.png">
  <!-- For iPhone 6 Plus with @3× display: -->
  <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/wip/images/apple-touch-icon-180x180-precomposed.png">
  <!-- For Chrome for Android: -->
  <link rel="icon" sizes="192x192" href="images/touch-icon-192x192.png">

  <!-- Diable crawling until this version is the stable version -->
  <meta name="robots" content="noindex" />
</head>


  <body>

    <!-- Google Tag Manager **This belongs right after the <body> tag**-->
    <noscript>
        <iframe src="//www.googletagmanager.com/ns.html?id=GTM-MWMDKN"
        height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <script>
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-MWMDKN');
    </script>
    <!-- End Google Tag Manager -->


    
<div class="version-banner">
    Hey, you're viewing the <strong>wip</strong> version of this page!
    <a href="/guides/rhinoscript/vbscript_err_objects/">View the current version instead.</a>
</div>



    <div class="container">

      <header class="site-header">


    <a class="site-title" href="/wip/"><img src="/wip/images/rhinodevlogo148x128.png" alt="Rhino Developer Docs" height="48" width="56"></a><a class="site-title" href="/wip/">Rhino Developer Docs</a>

    <nav class="site-nav">
      <img class="menu-icon" src="/wip/images/gi.svg">
      
      <div class="trigger">
      	<!--<a class="page-link" href="/wip/">Welcome</a>-->
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
        
          
            
              
                <a class="page-link" href="/wip/guides/">Guides</a>
              
            
          
        
          
            
              
                <a class="page-link" href="/wip/api/">API</a>
              
            
          
        
          
            
              
                <a class="page-link" href="/wip/samples/">Samples</a>
              
            
          
        
          
            
          
        
        <a class="page-link" href="http://discourse.mcneel.com/c/rhino-developer">Forums</a>
        <!-- Google Search Engine -->
        <!-- TODO Move to this site back into the Mcneel search, or use a simple site only search for results -->
        <div id="sitesearch">
            <!-- Google CSE Search Box Begins  -->
            <!-- Use of this code assumes agreement with the Google Custom Search Terms of Service. -->
            <!-- The terms of service are available at https://www.google.com/cse/docs/tos.html -->
            <form id="cref" action="/wip/search-results.html">
                <input type="hidden" name="cref" value="007988927381198593803:mcq6pshqsn8" />
                <input id="searchtext" type="text" name="q" size="24" value="" placeholder="search" />
                <input class="searchBox" type="submit" name="sa" size="2" value=" " />
            </form>
        <!-- Google CSE Search Box Ends -->
        </div>
        <!--End of Google Search Engine -->
      </div>
    </nav>

</header>


      <div class="page-content">
        <!--div class="wrapper"-->
          <div class="container-fluid">

<div class="row-fluid">
    <!--Nav Bar -->
    <nav class="col-xs-0 col-md-3 bs-docs-sidebar">
        <ul id="sidebar" class="nav nav-stacked fixed">

          <li>
            <a href="/wip/guides/">Guides</a>

            <ul class="nav nav-stacked">

              <li>

                
                  <a href="/wip/guides/#rhinoscript">RhinoScript</a>
                
                <ul class="nav nav-stacked">

                  <!-- Find the h1 handle for title -->
                  
                  
                  
                  
                  
                  
                  
                  <li>
                    <a href="#vbscript-err-objects">VBScript Err Objects</a>

                    <ul class="nav nav-stacked">

                      <!-- Find the h2 group and any h3 subgroups -->
                      

                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#overview">Overview</a>

                          

                        </li>
                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#details">Details</a>

                          

                        </li>
                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#using-on-error">Using On Error</a>

                          

                        </li>
                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#structured-exception-handling">Structured Exception Hand...</a>

                          

                        </li>
                      

                    </ul>

                  </li>

                </ul>

              </li>

            </ul>

          </li>

        </ul>
    </nav>
    <!--Main Content -->
    <div class="col-xs-12 col-md-9">
      <!--<div class="post">-->

        <article class="post-content">
          <h1 id="vbscript-err-objects">VBScript Err Objects</h1>

<p>This guide discusses the VBScript Err object.</p>

<h2 id="overview">Overview</h2>

<p>The VBScript <code class="highlighter-rouge">Err</code> object provides access to run-time error information.</p>

<p>The <code class="highlighter-rouge">Err</code> object encapsulates errors for a VBScript script.  By default, if an error occurs, VBScript terminates script execution and RhinoScript reports the error back to the user.  Sometimes this default error processing is not desirable.  In this case, the <code class="highlighter-rouge">Err</code> object and the <code class="highlighter-rouge">On Error</code> statement can be used to let scripts perform their own error handling.</p>

<h2 id="details">Details</h2>

<p>The <code class="highlighter-rouge">Err</code> object is a predefined global object.  It does not need to be declared before it can be used.  The object is used to encapsulate all the information relating to an error condition.  This information is presented as a series of properties:</p>

<ul>
  <li>The <code class="highlighter-rouge">.Number</code> property is the error number (or code) for the error.  This is the default property of the Err object.</li>
  <li>The <code class="highlighter-rouge">.Source</code> property contains a string that specifies the source of the error.  This is typically the <code class="highlighter-rouge">ProgID</code> (Programmatic Identifier) of the object that generated the error.</li>
  <li>The <code class="highlighter-rouge">.Description</code> property contains a string describing the error.</li>
  <li>The <code class="highlighter-rouge">.HelpFile</code> and <code class="highlighter-rouge">.HelpContext</code> properties store information to reference a help topic in a help file.  This allows the error to refer to information on possible causes of the error.</li>
</ul>

<h2 id="using-on-error">Using On Error</h2>

<p>To generate a user-defined run-time error, first clear the <code class="highlighter-rouge">Err</code> object using the <code class="highlighter-rouge">.Clear</code> method.  Then raise the error using the <code class="highlighter-rouge">.Raise</code> method.  This method takes up to five arguments that correspond, in order, to the properties previously listed.  For example:</p>

<pre><code class="language-vbnet">Err.Clear
Err.Raise 1000, "This is a script-defined error", "Test Script"
</code></pre>

<p>This example displays the standard RhinoScript error dialog box showing the error information.</p>

<p>To intercept run-time errors and process them in scripts, use the <code class="highlighter-rouge">On Error</code> statement.  The syntax of this statement is:</p>

<pre><code class="language-vbnet">On Error Resume Next
</code></pre>

<p>After this statement executes, the next run-time errors do not cause script execution to end.  Instead, the <code class="highlighter-rouge">Err</code> object properties are set to reflect the error information and processing continues with the next statement.  For example:</p>

<pre><code class="language-vbnet">Err.Clear
On Error Resume Next
Err.Raise 100, "Script Error"
If Err.Number Then Rhino.Print "Error=" &amp; CInt(Err.Number)
</code></pre>

<p>In this example, the <code class="highlighter-rouge">Err.Raise</code> method is used to raise a run-time error.  Normally, this would stop script execution.  However, the earlier <code class="highlighter-rouge">On Error</code> statement allows script execution to continue.  So the If statement executes and displays the error number.</p>

<p>In the preceding example, the error was generated by the <code class="highlighter-rouge">Err.Raise</code> method. Yet, the same processing applies to any run-time error, regardless of how it is generated.  For example:</p>

<pre><code class="language-vbnet">On Error Resume Next
Err.Clear
x = CInt("foo")
If Err.Number &lt;&gt; 0 Then
  Rhino.Print Err.Number
  Rhino.Print Err.Description
  Rhino.Print Err.Source
End If
</code></pre>

<p>Here, an attempt is made to convert the string <code class="highlighter-rouge">"foo"</code> into an integer.  Because this is an invalid conversion, a run-time type mismatch error is generated.  The information on this error is placed in the <code class="highlighter-rouge">Err</code> object.  This is then processed by the <code class="highlighter-rouge">If</code> statement.</p>

<p>After an <code class="highlighter-rouge">On Error</code> statement executes, it remains in effect for the rest of the procedure in which it executes.  If the <code class="highlighter-rouge">On Error</code> statement executes in global scope, it remains in effect until the script terminates.  Nested procedures can each have their own <code class="highlighter-rouge">On Error</code> statement.  For example, subroutine A can execute an <code class="highlighter-rouge">On Error</code> statement and then execute subroutine B, which in turn, executes an <code class="highlighter-rouge">On Error</code> statement.</p>

<p>If an error occurs while an <code class="highlighter-rouge">On Error</code> statement is active, execution continues with the following statement in the same scope as the most recently executed <code class="highlighter-rouge">On Error</code> statement.  For example:</p>

<pre><code class="language-vbnet">On Error Resume Next
Rhino.Print "Begin"
Sub1
Rhino.Print "End"
Sub Sub1
  Rhino.Print "Enter Sub1"
  Err.Raise 100
  Rhino.Print "Leave Sub1"
End Sub
</code></pre>

<p>In this example, an <code class="highlighter-rouge">On Error</code> statement executes at global scope, and then the <code class="highlighter-rouge">Sub1</code> procedure executes. Within this procedure, an <code class="highlighter-rouge">Err.Raise</code> method is used to generate an error.  Because the most recently executed error is at global scope, the next statement to execute is the <code class="highlighter-rouge">Rhino.Print</code> statement at global scope, and not the <code class="highlighter-rouge">Rhino.Print</code> statement following the <code class="highlighter-rouge">Err.Raise</code> statement.  In fact, the error causes VBScript to abandon further execution of the statements in <code class="highlighter-rouge">Sub1</code> and continue execution at global scope.  Thus, the output of this script is:</p>

<pre><code class="language-vbs">Begin
Enter Sub1
End
</code></pre>

<p>Notice that the final <code class="highlighter-rouge">Rhino.Print</code> statement in <code class="highlighter-rouge">Sub1</code> never executes. When an error occurs, VBScript immediately abandons execution of any running procedures necessary to resume with the correct statement after an error.  For example:</p>

<pre><code class="language-vbnet">On Error Resume Next
Rhino.Print "Begin"
Sub1
Rhino.Print "End"

Sub Sub1
  Rhino.Print "Enter Sub1"
  Sub2
  Rhino.Print "Leave Sub1"
End Sub

Sub Sub2
  Rhino.Print "Enter Sub2"
  Err.Raise 100
  Rhino.Print "Leave Sub2"
End Sub
</code></pre>

<p>Here, the <code class="highlighter-rouge">Err.Raise</code> method invocation is nested even more deeply.  In this case, when the error occurs, VBScript abandons further execution of both <code class="highlighter-rouge">Sub1</code> and <code class="highlighter-rouge">Sub2</code> to continue execution at the global level.</p>

<p>Because VBScript abandons execution of procedures only until it finds the most recently executed <code class="highlighter-rouge">On Error</code> statement, it is possible to capture an error within a procedure simply by placing an <code class="highlighter-rouge">On Error</code> statement in that procedure.  For example:</p>

<pre><code class="language-vbnet">On Error Resume Next
Rhino.Print "Begin"
Sub1
Rhino.Print "End"

Sub Sub1
  Rhino.Print "Enter Sub1"
  On Error Resume Next
  Sub2
  Rhino.Print "Leave Sub1"
End Sub

Sub Sub2
  Rhino.Print "Enter Sub2"
  Err.Raise 100
  Rhino.Print "Leave Sub2"
End Sub
</code></pre>

<p>This example modifies the previous example by adding an <code class="highlighter-rouge">On Error</code> statement to the <code class="highlighter-rouge">Sub1</code> procedure.  So, when the <code class="highlighter-rouge">Err.Raise</code> method in <code class="highlighter-rouge">Sub2</code> executes, execution continues with the next statement in <code class="highlighter-rouge">Sub1</code>. Notice that the <code class="highlighter-rouge">Leave Sub2</code> line never executes.  The output from this example is:</p>

<pre><code class="language-vbs">Begin
Enter Sub1
Enter Sub2
Leave Sub1
End
</code></pre>

<h2 id="structured-exception-handling">Structured Exception Handling</h2>

<p>The <code class="highlighter-rouge">On Error</code> statement is a simple form of a technique known as structured exception handling.  The basic idea behind this technique is to centralize all the error handling code in a single location outside of the main flow of the program.  This is the reason for the complex behavior of the <code class="highlighter-rouge">On Error</code> statement.</p>

<p>The assumption is that a large script might contain many procedures that interact in complex ways.  It is possible that an error will occur when procedures are nested very deeply.  Without the <code class="highlighter-rouge">On Error</code> statement, each procedure must return some form of error code to the procedure from which it was called.  In turn, this procedure must do the same thing, and so on for all the nested procedures.  This can greatly add to the complexity of the script.</p>

<p>With the <code class="highlighter-rouge">On Error</code> statement, this complexity can be avoided.  When an error occurs, VBScript automatically takes care of unwinding out of the complex nest of procedures back to the statement that followed the original procedure invocation.</p>

        </article>

      <!--</div>-->

    </div>
</div>
</div>

        <!--/div-->
      </div>

      <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">

      
        <div class="row">
          <div class="col-md-4">
            <p class="text">Author: <a href="mailto:dale@mcneel.com">dale@mcneel.com</a></p>
          </div>
          <div class="col-md-4 text-center">
            <span class="icon  icon--github">
              <svg viewBox="0 0 16 16">
                <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <a href="https://github.com/mcneel/developer-rhino3d-com/blob/wip/_guide_topics/rhinoscript/vbscript_err_objects.md" target="_blank">Edit page on GitHub</a>
          </div>
            <div class="col-md-4">
              <span class="pull-right">
                <span class="glyphicon glyphicon-cog"></span>&nbsp;<a href="/wip/admin">Admin</a>
              </span>
            </div>
        </div>

        <div class="row text-center">
          © 1997 - 2016 Robert McNeel &amp; Associates
        </div>

      

    </div>

  </div>

  <script>
    if (navigator.appVersion.indexOf("Win")!=-1)
    {
      var body = document.getElementsByTagName("body");
      body[0].style.fontWeight = '400';
    }
  </script>

</footer>

    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

    <!-- MathJax -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <script type="text/javascript">
    $('body').scrollspy({
        target: '.bs-docs-sidebar',
        offset: 150 /* fixed header is about 40px high */
    });
    </script>
  </body>

</html>
