<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>VBScript RegExp Objects</title>
  <meta name="description" content="VBScript RegExp Objects">

  <!-- OpenGraph for Facebook, Twitter, Slack unfurling -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/guides/rhinoscript/vbscript_regexp_objects/" />
  <meta property="og:title" content="VBScript RegExp Objects" />
  <meta property="og:description" content="This guide discusses the VBScript RegExp object." />
  <meta property=”og:site_name” content="developer.rhino3d.com"/>
  <meta property=”og:image” content="/wip/images/rhinodev_logo_unfurl.png"/>

  <!-- twitter card tags additive with the og: tags -->
  <meta name="twitter:domain" value="developer.rhino3d.com" />
  <meta name="twitter:title" value="VBScript RegExp Objects" />
  <meta name="twitter:description" value="This guide discusses the VBScript RegExp object." />
  
    
      <meta name="twitter:image" content="/wip/images/rhinodev_logo_unfurl.png" />
    
  
  <meta name="twitter:url" value="http://developer.rhino3d.com" />
  
  <meta name="twitter:label1" value="Platform(s)" />
  <meta name="twitter:data1" value="Windows" />
  
  
  <meta name="twitter:label2" value="Language(s)" />
  <meta name="twitter:data2" value="VBScript" />
  

  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css">
  <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/languages/vbnet.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <!-- Check the version banner for broken links and remove the link if found -->
  <!-- <script type="text/javascript" src="/script/banner_sanity.js"></script> -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script>
  $.ready(function()
  {
  	var splitPath = window.location.pathname.split("/");
  	var nonWipURL = "/" + splitPath.splice(2,splitPath.length-2).join("/");

  	$.get(nonWipURL).fail(function ()
  	{
      console.log("stripping link");
      var $aTag = $("div.version-banner > a");
  		$aTag.remove();
  	});
  });
  </script>

  <!-- Overridden theme -->
  <link rel="stylesheet" href="/wip/css/main.css">

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
  <!-- Bootstrap override -->
  <link rel="stylesheet" href="/wip/css/bootstrap-override.css">

  <link rel="canonical" href="http://developer.rhino3d.com/wip/guides/rhinoscript/vbscript_regexp_objects/">
  <link rel="alternate" type="application/rss+xml" title="Rhino Developer Docs" href="http://developer.rhino3d.com/wip/feed.xml" />

  <link rel="shortcut icon" href="http://developer.rhino3d.com/favicon.ico?v=2" />
  <!-- Saving bookmarks to mobile devices -->
  <!-- For non-Retina (@1× display) iPhone, iPod Touch, and Android 2.1+ devices: -->
  <link rel="apple-touch-icon-precomposed" href="/wip/images/apple-touch-icon-precomposed.png"><!-- 57×57px -->
  <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/wip/images/apple-touch-icon-72x72-precomposed.png">
  <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/wip/images/apple-touch-icon-76x76-precomposed.png">
  <!-- For iPhone with @2× display running iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/wip/images/apple-touch-icon-114x114-precomposed.png">
  <!-- For iPhone with @2× display running iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/wip/images/apple-touch-icon-120x120-precomposed.png">
  <!-- For iPad with @2× display running iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/wip/images/apple-touch-icon-144x144-precomposed.png">
  <!-- For iPad with @2× display running iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/wip/images/apple-touch-icon-152x152-precomposed.png">
  <!-- For iPhone 6 Plus with @3× display: -->
  <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/wip/images/apple-touch-icon-180x180-precomposed.png">
  <!-- For Chrome for Android: -->
  <link rel="icon" sizes="192x192" href="images/touch-icon-192x192.png">

  <!-- Diable crawling until this version is the stable version -->
  <meta name="robots" content="noindex" />
</head>


  <body>

    <!-- Google Tag Manager **This belongs right after the <body> tag**-->
    <noscript>
        <iframe src="//www.googletagmanager.com/ns.html?id=GTM-MWMDKN"
        height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <script>
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-MWMDKN');
    </script>
    <!-- End Google Tag Manager -->


    
<div class="version-banner">
    Hey, you're viewing the <strong>wip</strong> version of this page!
    <a href="/guides/rhinoscript/vbscript_regexp_objects/">View the current version instead.</a>
</div>



    <div class="container">

      <header class="site-header">


    <a class="site-title" href="/wip/"><img src="/wip/images/rhinodevlogo148x128.png" alt="Rhino Developer Docs" height="48" width="56"></a><a class="site-title" href="/wip/">Rhino Developer Docs</a>

    <nav class="site-nav">
      <img class="menu-icon" src="/wip/images/gi.svg">
      
      <div class="trigger">
      	<!--<a class="page-link" href="/wip/">Welcome</a>-->
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
        
          
            
              
                <a class="page-link" href="/wip/guides/">Guides</a>
              
            
          
        
          
            
              
                <a class="page-link" href="/wip/api/">API</a>
              
            
          
        
          
            
              
                <a class="page-link" href="/wip/samples/">Samples</a>
              
            
          
        
          
            
          
        
        <a class="page-link" href="http://discourse.mcneel.com/c/rhino-developer">Forums</a>
        <!-- Google Search Engine -->
        <!-- TODO Move to this site back into the Mcneel search, or use a simple site only search for results -->
        <div id="sitesearch">
            <!-- Google CSE Search Box Begins  -->
            <!-- Use of this code assumes agreement with the Google Custom Search Terms of Service. -->
            <!-- The terms of service are available at https://www.google.com/cse/docs/tos.html -->
            <form id="cref" action="/wip/search-results.html">
                <input type="hidden" name="cref" value="007988927381198593803:mcq6pshqsn8" />
                <input id="searchtext" type="text" name="q" size="24" value="" placeholder="search" />
                <input class="searchBox" type="submit" name="sa" size="2" value=" " />
            </form>
        <!-- Google CSE Search Box Ends -->
        </div>
        <!--End of Google Search Engine -->
      </div>
    </nav>

</header>


      <div class="page-content">
        <!--div class="wrapper"-->
          <div class="container-fluid">

<div class="row-fluid">
    <!--Nav Bar -->
    <nav class="col-xs-0 col-md-3 bs-docs-sidebar">
        <ul id="sidebar" class="nav nav-stacked fixed">

          <li>
            <a href="/wip/guides/">Guides</a>

            <ul class="nav nav-stacked">

              <li>

                
                  <a href="/wip/guides/#rhinoscript">RhinoScript</a>
                
                <ul class="nav nav-stacked">

                  <!-- Find the h1 handle for title -->
                  
                  
                  
                  
                  
                  
                  
                  <li>
                    <a href="#vbscript-regexp-objects">VBScript RegExp Objects</a>

                    <ul class="nav nav-stacked">

                      <!-- Find the h2 group and any h3 subgroups -->
                      

                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#overview">Overview</a>

                          

                        </li>
                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#using-regexp">Using RegExp</a>

                          

                        </li>
                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#regular-expression-syntax">Regular Expression syntax</a>

                          

                        </li>
                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#regexp-example">RegExp Example</a>

                          

                        </li>
                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#the-replace-method">The .Replace Method</a>

                          

                        </li>
                      

                    </ul>

                  </li>

                </ul>

              </li>

            </ul>

          </li>

        </ul>
    </nav>
    <!--Main Content -->
    <div class="col-xs-12 col-md-9">
      <!--<div class="post">-->

        <article class="post-content">
          <h1 id="vbscript-regexp-objects">VBScript RegExp Objects</h1>

<p>This guide discusses the VBScript RegExp object.</p>

<h2 id="overview">Overview</h2>

<p>The VBScript <code class="highlighter-rouge">RegExp</code> object matches strings against special text patterns, called regular expressions.</p>

<p>The <code class="highlighter-rouge">InStr</code> function can be used to search a string to see if it contains another string.  The <code class="highlighter-rouge">RegExp</code> object provides a far more sophisticated string searching facility by using regular expressions.</p>

<p>A regular expression is a string that describes a match pattern.  The match pattern provides a template that can be used to test another string, the search string, for a matching sub-string.  In its simplest form, the match pattern string is just a sequence of characters that must be matched.  For example, the pattern <code class="highlighter-rouge">"fred"</code> matches this exact sequence of characters and only this sequence.  More sophisticated regular expressions can match against items such as file names, path names, and Internet URLs.  Thus, the <code class="highlighter-rouge">RegExp</code> object is frequently used to validate data for correct form and syntax.</p>

<h2 id="using-regexp">Using RegExp</h2>

<p>To test a search string against a match pattern, create a <code class="highlighter-rouge">RegExp</code> object and set the match pattern.  Then use the <code class="highlighter-rouge">.Test</code> method to test for a match.  For example:</p>

<pre><code class="language-vbnet">Dim oRE, bMatch
Set oRE = New RegExp
oRE.Pattern = "fred"
bMatch = oRE.Test("His name was fred brown")
</code></pre>

<p>Regular expression objects are created using <code class="highlighter-rouge">the</code> New keyword.  This is an anomaly of VBScript, because it is the only object, apart from user-defined objects, that is created in this manner.  Once created in this way, the methods and properties of the object are accessed normally.</p>

<p>The <code class="highlighter-rouge">.Pattern</code> property defines the match pattern, and the <code class="highlighter-rouge">.Test</code> method tests the supplied string against this match pattern, returning True if the match pattern is found within the supplied string.  In the preceding example, <code class="highlighter-rouge">bMatch</code> is set to True as there is clearly a match.</p>

<p>The <code class="highlighter-rouge">.Execute</code> method of the <code class="highlighter-rouge">RegExp</code> object also checks for a pattern match, but it returns a <code class="highlighter-rouge">Matches</code> collection object that contains detailed information on each pattern match.  The <code class="highlighter-rouge">Matches</code> object is a normal collection object containing a <code class="highlighter-rouge">.Count</code> property and a default <code class="highlighter-rouge">.Item</code> property.  Each item in the <code class="highlighter-rouge">Matches</code> object is a <code class="highlighter-rouge">Match</code> object that describes a specific pattern match.  After the <code class="highlighter-rouge">.Execute</code> method is invoked, the returned <code class="highlighter-rouge">Matches</code> object contains a <code class="highlighter-rouge">Match</code> object for each match located in the search string.</p>

<p>Each <code class="highlighter-rouge">Match</code> item has three properties.  The <code class="highlighter-rouge">.Value</code> property contains the actual text in the search string that was matched.  The <code class="highlighter-rouge">.FirstIndex</code> property contains the index of the first character of the match in the search string.  The <code class="highlighter-rouge">.Length</code> property contains the length of the matched string.  Unlike other VBScript string indexes, the <code class="highlighter-rouge">.FirstIndex</code> property uses 0 as the index of the first character in the string.  Therefore, always add one to this value before using it with other VBScript string functions.</p>

<p>By default, the <code class="highlighter-rouge">.Execute</code> method only matches the first occurrence of the pattern.  If the <code class="highlighter-rouge">.Global</code> property is set to True, the method matches all the occurrences in the string and returns a <code class="highlighter-rouge">Match</code> object for each match.  For example:</p>

<pre><code class="language-vbnet">Dim oRE, oMatches
Set oRE = New RegExp
oRE.Pattern = "two"
oRE.Global = True
Set oMatches = oRE.Execute("two times three equals three times two")
For Each oMatch In oMatches
  Rhino.Print "Match: " &amp; oMatch.Value &amp; " At: " &amp; CStr(oMatch.FirstIndex + 1)
Next
</code></pre>

<p>This example lists all the matches against the pattern <code class="highlighter-rouge">"two"</code> in the specified string.</p>

<p>Simple match patterns, such as those shown in the previous example, provide no additional functionality over that provided by the <code class="highlighter-rouge">InStr</code> function.  Much more powerful searches are available, however, by using the special regular expression features of the search pattern.  These are most easily explored using the sample script shown below:</p>

<pre><code class="language-vbnet">Sub TestRegExp(sPattern, sSearch)

  ' Do the regular expression match
  Dim oRE, oMatches
  Set oRE = New RegExp
  oRE.Global = True
  oRE.IgnoreCase = True
  oRE.Pattern = sPattern
  Set oMatches = oRE.Execute(sSearch)

  ' Now process all the matches (if any)
  Dim oMatch
  Rhino.Print "Pattern String: " &amp; Chr(34) &amp; sPattern &amp; Chr(34)
  Rhino.Print "Search String: " &amp; Chr(34) &amp; sSearch &amp; Chr(34) &amp; VbCrLf
  Rhino.Print "Matches: " &amp; CStr(oMatches.Count)
  Rhino.Print "    " &amp; sSearch
  For Each oMatch In oMatches
    Rhino.Print "    " &amp; String(oMatch.FirstIndex, " ") &amp; String(oMatch.Length, "^")
  Next

End Sub
</code></pre>

<p>To use the script, call the subroutine two arguments.  Enter a match pattern as the first argument and a search string as the second argument.  If either argument contains spaces or special shell characters, enclose the argument in double quotes.  The script uses the <code class="highlighter-rouge">.Execute</code> method of the <code class="highlighter-rouge">RegExp</code> object to locate all matches and then displays these matches graphically.  Use this script to experiment with the various advanced regular expression features described in the following paragraphs.  (Several of the preceding <code class="highlighter-rouge">Rhino.Print</code> statements use the expression <code class="highlighter-rouge">Chr( )</code>.  This simply evaluates to a double quote character.)</p>

<h2 id="regular-expression-syntax">Regular Expression syntax</h2>

<p>Within the match pattern, letters, digits, and most punctuation simply match a corresponding character in the search string.  A sequence of these characters matches the equivalent sequence in the search string.  However, some characters within the match pattern have special meaning.  For example, the <code class="highlighter-rouge">"."</code> (period) character matches any character except a new-line character.  Thus, the match pattern <code class="highlighter-rouge">"a.c"</code> matches <code class="highlighter-rouge">"abc"</code> or <code class="highlighter-rouge">"adc"</code> or <code class="highlighter-rouge">"a$c"</code>. The match pattern <code class="highlighter-rouge">".."</code> matches any sequence of two characters.</p>

<p>The special character <code class="highlighter-rouge">"^"</code> matches the start of the string.  Thus, the match pattern <code class="highlighter-rouge">"^abc"</code> matches the string <code class="highlighter-rouge">"abc"</code>, but not <code class="highlighter-rouge">"123abc"</code> because this string does not begin with <code class="highlighter-rouge">"abc"</code>.  Similarly, the special character <code class="highlighter-rouge">"$"</code> matches the end of the string, and so the pattern <code class="highlighter-rouge">"red$"</code> matches the search string <code class="highlighter-rouge">"fred"</code>, but not <code class="highlighter-rouge">"fred brown"</code>.</p>

<p>Using both these characters allows a regular expression to match complete strings.  For example, the pattern <code class="highlighter-rouge">"abc"</code> matches <code class="highlighter-rouge">"123 abc that"</code> and any other string containing <code class="highlighter-rouge">"abc"</code>, whereas the pattern <code class="highlighter-rouge">"^abc$"</code> only matches the exact string <code class="highlighter-rouge">"abc"</code>.</p>

<p>The three characters <code class="highlighter-rouge">*</code>, <code class="highlighter-rouge">+</code>, and <code class="highlighter-rouge">?</code> are called modifiers.  These characters modify the preceding character.  The <code class="highlighter-rouge">*</code> modifier matches the preceding character zero or more times, the <code class="highlighter-rouge">+</code> modifier matches the preceding character one or more times, and the <code class="highlighter-rouge">"?"</code> modifier matches the preceding character zero or one time.  For example, the pattern “a+” matches any sequence of one or more <code class="highlighter-rouge">"a"</code> characters, whereas the pattern <code class="highlighter-rouge">"ab*c"</code> matches <code class="highlighter-rouge">"abc"</code>, <code class="highlighter-rouge">"abbbbbc"</code>, and <code class="highlighter-rouge">"ac"</code>, but not <code class="highlighter-rouge">"adc"</code> or <code class="highlighter-rouge">"ab"</code>.</p>

<p>A list of characters enclosed in brackets is called a range and matches a single character in the search string with any of the characters in brackets.  For example, the pattern <code class="highlighter-rouge">"[0123456789]"</code> matches any digit character in the search string.  Ranges such as this, where the characters are sequential, can be abbreviated as <code class="highlighter-rouge">"[0-9]"</code>.  For example, the pattern <code class="highlighter-rouge">"[0-9a-zA-Z_]"</code> matches a digit, letter (either upper or lower case), or the underscore character.  If the first character of the range is <code class="highlighter-rouge">"^"</code>, the range matches all those characters that are not listed.  For example, <code class="highlighter-rouge">"[^0-9]"</code> matches any non-digit character.</p>

<p>Ranges can be combined with modifiers. For example, the pattern <code class="highlighter-rouge">"[0-9]+"</code> matches any sequence of one or more digit characters. The pattern <code class="highlighter-rouge">"[a-zA-Z][a-zA-Z_0-9]*"</code> matches a valid VBScript variable name, because it only matches sequences that start with a letter and are followed by zero or more letters, digits, or underscore characters.</p>

<p>To match a character an exact number of times, follow the character in the pattern by a count of matches required enclosed in braces.  For example, the pattern <code class="highlighter-rouge">"a{3}"</code> matches exactly three <code class="highlighter-rouge">"a"</code> characters, and it is equivalent to the pattern <code class="highlighter-rouge">"aaa"</code>.  If a comma follows the count, the character is matched at least that number of times. For example, <code class="highlighter-rouge">"a{5,}"</code> matches five or more <code class="highlighter-rouge">"a"</code> characters.  Finally, use two counts to specify a lower and upper bound. For example, the pattern <code class="highlighter-rouge">"a{4,8}"</code> matches between four and eight <code class="highlighter-rouge">"a"</code> characters.</p>

<p>As with other modifiers, the pattern count modifier can be combined with ranges.  For example, the pattern <code class="highlighter-rouge">"[0-9]{4}"</code> matches exactly four digits.</p>

<p>Use parentheses in the match pattern to group individual items together.  Modifiers can then be applied to the entire group of items. For example, the pattern <code class="highlighter-rouge">"(abc)+"</code> matches any number of repeats of the sequence <code class="highlighter-rouge">"abc"</code>.  The pattern <code class="highlighter-rouge">"(a[0-9]c){1,2}"</code> matches strings such as <code class="highlighter-rouge">"a0c"</code> and <code class="highlighter-rouge">"a4ca5c"</code>.</p>

<p>There is a difference between matching the pattern <code class="highlighter-rouge">"abc"</code> and the pattern <code class="highlighter-rouge">"(abc)+"</code> using the <code class="highlighter-rouge">RegExp</code> object.  Matching the pattern <code class="highlighter-rouge">"abc"</code> against the search string <code class="highlighter-rouge">"abcabcabc"</code> generates three individual matches and results in three <code class="highlighter-rouge">Match</code> objects in the Matches collection.  Matching the pattern <code class="highlighter-rouge">"(abc)+"</code> against the same string generates one match that matches the entire string.</p>

<p>The <code class="highlighter-rouge">"I"</code> vertical bar character separates lists of alternate sub-expressions.  For example, the pattern <code class="highlighter-rouge">"abIac"</code> matches the strings <code class="highlighter-rouge">"ab"</code> or <code class="highlighter-rouge">"ac"</code>. The vertical bar separates entire regular expressions.  The pattern <code class="highlighter-rouge">"^abIac$"</code> matches either the string <code class="highlighter-rouge">"ab"</code> at the start of the search string or the string <code class="highlighter-rouge">"ac"</code> at the end of the search string. Use parentheses to specify alternates within a larger pattern.  For example, the pattern <code class="highlighter-rouge">"^(abIac)$"</code> matches the exact strings <code class="highlighter-rouge">"ab"</code> or <code class="highlighter-rouge">"ac"</code> only.</p>

<p>To match any of the special characters literally in a pattern, they must be preceded by a back-slash character, which is known as an escape.  For example, to match a literal asterisk, use <code class="highlighter-rouge">"\*"</code> in the pattern.  To match a back-slash itself, use two back-slash characters in the match pattern.  The following characters must be escaped when used literally within a match pattern:</p>

<pre><code class="language-regex">. (period) * + ? \ ( ) [ ] { } ^ $
</code></pre>

<p>There are also several additional escape sequences that provide useful shorthand for more complex patterns:</p>

<ul>
  <li>The <code class="highlighter-rouge">"\d"</code> escape matches any digit, and it is equivalent to <code class="highlighter-rouge">"[0-9]"</code>. The <code class="highlighter-rouge">"\D"</code> escape matches any non-digit, and it is equivalent to <code class="highlighter-rouge">"[^0-9]"</code>.</li>
  <li>The <code class="highlighter-rouge">"\w"</code> escape matches any word character and is equivalent to <code class="highlighter-rouge">"[0-9a-zA-Z_]"</code>, and the <code class="highlighter-rouge">"\W"</code> escape matches any non-word character.</li>
  <li>The <code class="highlighter-rouge">"\b"</code> escape matches a word boundary, which is the boundary between any word character and a non-word character, whereas <code class="highlighter-rouge">"\B"</code> matches a non-word boundary.</li>
  <li>The <code class="highlighter-rouge">"\s"</code> escape matches any whitespace character, including space, tab, new-line, and so on, whereas the <code class="highlighter-rouge">"\S"</code> escape matches any non-whitespace character.</li>
</ul>

<p>Finally, certain escapes can match non-printing characters, as follows:</p>

<ul>
  <li>The <code class="highlighter-rouge">"\f"</code> escape matches a form-feed character.</li>
  <li>The <code class="highlighter-rouge">"\n"</code> escape matches a new-line character.</li>
  <li>The <code class="highlighter-rouge">"\r"</code> escape matches a carriage-return character.</li>
  <li>The <code class="highlighter-rouge">"\t"</code> escape matches a tab character.</li>
  <li>The <code class="highlighter-rouge">"\v"</code> escape matches a vertical tab character.</li>
  <li>The <code class="highlighter-rouge">"\onn"</code> escape matches a character whose octal code is <code class="highlighter-rouge">nn</code>.</li>
  <li>The <code class="highlighter-rouge">"\xnn"</code> escape matches a character whose hexadecimal code is <code class="highlighter-rouge">nn</code>.</li>
</ul>

<p>The special escape <code class="highlighter-rouge">"\n"</code>, where n is a digit, matches the search text previously matched by a sub-expression in parentheses.  Each sub-expression in a match pattern is numbered from left to right, and the escape <code class="highlighter-rouge">"\n"</code> matches the nth sub-expression.  For example, the pattern <code class="highlighter-rouge">"(..)\1"</code> matches any two character sequence that repeats twice, such as <code class="highlighter-rouge">"abab"</code>.  The first sub-expression matches the first two characters, <code class="highlighter-rouge">"ab"</code>, and the <code class="highlighter-rouge">"\1"</code> escape then matches these same two characters again.</p>

<h2 id="regexp-example">RegExp Example</h2>

<p>Regular expression match patterns provide a powerful way to validate the syntax of strings.  For example, a script can obtain strings from a formatted text file and parse it into recognizable tokens.  A regular expression can be used for this purpose.</p>

<p>This script is simplistic in that it simply breaks apart each argument at the <code class="highlighter-rouge">"="</code> sign - no attempt is made to check if the name and value parts are valid.  The following regular expression matches these command line arguments:</p>

<pre><code class="language-regex">[^=]+=.*
</code></pre>

<p>This match pattern is interpreted as follows: The range <code class="highlighter-rouge">"[^=]"</code> matches any character that is not an <code class="highlighter-rouge">"="</code> sign.  The <code class="highlighter-rouge">"+"</code> modifier following the range means that the pattern matches any set of one or more characters that are not <code class="highlighter-rouge">"="</code> signs.  The next <code class="highlighter-rouge">"="</code> sign in the pattern matches a literal <code class="highlighter-rouge">"="</code> sign (that is, the separator between the name and value parts).  Finally, the <code class="highlighter-rouge">".*"</code> pattern matches any sequence of zero or more characters.</p>

<p>Parentheses can be used to make the meaning more clear.  For example:</p>

<pre><code class="language-regex">([^=]+)=(.*)
</code></pre>

<p>This example is identical to the previous example, but the parentheses help make the individual parts of the pattern more understandable.</p>

<p>Typically, the name in the previous example should be restricted to a valid name.  We define valid names as a letter followed by zero or more letters, digits, or underscores.  This yields a new regular expression as follows:</p>

<pre><code class="language-regex">([a-zA-Z]\w*)=(.*)
</code></pre>

<p>Here, the pattern <code class="highlighter-rouge">"[a-zA-Z]"</code> matches any single letter. Then the pattern <code class="highlighter-rouge">"\w*"</code> matches zero or more letters, digits, or underscores, using the <code class="highlighter-rouge">"\w"</code> escape as a shorthand for <code class="highlighter-rouge">"[0-9a-zA-Z]"</code>.</p>

<p>The previous regular expression does not allow spaces before or after the name.  For example, only the first of these strings matches the expression:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>curve=123456
curve = 575888
curve  = 5544
</code></pre>
</div>

<p>The following regular expression corrects this by adding optional leading and trailing whitespace around the name:</p>

<pre><code class="language-regex">(\s*)([a-zA-Z]\w*)(\s*)=(.*)
</code></pre>

<p>The new addition, <code class="highlighter-rouge">"\s*"</code>, matches zero or more whitespace characters.</p>

<h2 id="the-replace-method">The .Replace Method</h2>

<p>Matching patterns against strings allows a script to determine if a string follows a specific syntax, as shown in the previous examples.  The <code class="highlighter-rouge">RegExp</code> object can also be used to assist in modifying the search string.  This facility is provided by the <code class="highlighter-rouge">.Replace</code> method, which takes two arguments: the search string and a replacement string, and returns a new string in which all matches in the search string are replaced by the replacement string.  For example:</p>

<pre><code class="language-vbnet">Set oRE = New RegExp
oRE.Global = True
oRE.Pattern = "a"
Wscript.Echo oRE.Replace("all a's are replaced", "X")
</code></pre>

<p>In this example, any <code class="highlighter-rouge">"a"</code> character in the search string is replaced by an <code class="highlighter-rouge">"X"</code> character.  The pattern and replacement strings do not need to be the same length.  For example:</p>

<pre><code class="language-vbnet">oRE.Pattern = "\s+"
Wscript.Echo oRE.Replace("compress  all      whitespace    ", " ")
</code></pre>

<p>Here, all sequences of whitespace are replaced by a single space character.</p>

<p>Within the replacement string, the special character sequence <code class="highlighter-rouge">"$n"</code> is allowed.  If present, this sequence is replaced by the text matched by the nth sub-expression in the pattern.  For example:</p>

<pre><code class="language-vbnet">oRE.Pattern = "^\s*(\w+)\s*=\s*(\w+)\s*$"
sSearch = "    this    = that"
Rhino.Print oRE.Replace(sSearch, "$1,$2")
</code></pre>

<p>This example works as follows:</p>

<p>The pattern contains both the start of string <code class="highlighter-rouge">"^"</code> and end of string <code class="highlighter-rouge">"$"</code> characters.  This means that the pattern either matches the entire search string or not at all.</p>

<p>The pattern matches any whitespace and sequence of one or more word characters, more whitespace, an <code class="highlighter-rouge">"="</code> sign, more whitespace, another set of word characters, and finally more whitespace.</p>

<p>Both the word patterns are in parentheses, marking them as sub-expressions 1 and 2 respectively.</p>

<p>When the <code class="highlighter-rouge">.Replace</code> method is invoked, it matches successfully against the entire search string.  This means that the replacement string replaces the entire contents of the search string, because this entire string matched the regular expression.  Thus, the string returned by <code class="highlighter-rouge">.Replace</code> is simply the replacement string.</p>

<p>The replacement string is <code class="highlighter-rouge">"$1,$2"</code>. As noted, the two sub-expressions in the pattern contain the two words matched in the search string, which in this case are <code class="highlighter-rouge">"this"</code> and <code class="highlighter-rouge">"that"</code>. Thus, the replacement string becomes <code class="highlighter-rouge">"this,that"</code>, and this is the value returned.</p>

<p>The result of this processing is that the <code class="highlighter-rouge">RegExp</code> object has validated the search string against the match pattern and extracted the required elements from the search string.</p>

        </article>

      <!--</div>-->

    </div>
</div>
</div>

        <!--/div-->
      </div>

      <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">

      
        <div class="row">
          <div class="col-md-4">
            <p class="text">Author: <a href="mailto:dale@mcneel.com">dale@mcneel.com</a></p>
          </div>
          <div class="col-md-4 text-center">
            <span class="icon  icon--github">
              <svg viewBox="0 0 16 16">
                <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <a href="https://github.com/mcneel/developer-rhino3d-com/blob/wip/_guide_topics/rhinoscript/vbscript_regexp_objects.md" target="_blank">Edit page on GitHub</a>
          </div>
            <div class="col-md-4">
              <span class="pull-right">
                <span class="glyphicon glyphicon-cog"></span>&nbsp;<a href="/wip/admin">Admin</a>
              </span>
            </div>
        </div>

        <div class="row text-center">
          © 1997 - 2016 Robert McNeel &amp; Associates
        </div>

      

    </div>

  </div>

  <script>
    if (navigator.appVersion.indexOf("Win")!=-1)
    {
      var body = document.getElementsByTagName("body");
      body[0].style.fontWeight = '400';
    }
  </script>

</footer>

    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

    <!-- MathJax -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <script type="text/javascript">
    $('body').scrollspy({
        target: '.bs-docs-sidebar',
        offset: 150 /* fixed header is about 40px high */
    });
    </script>
  </body>

</html>
